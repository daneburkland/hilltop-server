generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "debian-openssl-1.1.x"]
}

datasource db {
  provider = "postgresql"
  url = "***"
}

model TestRun {
  id             Int      @default(autoincrement()) @id
  test           Test     @relation(fields: [testId], references: [id])
  testId         Int
  result         String
  createdAt      DateTime @default(now())
  logs           Log[]
  screenshotUrls String[]
}

model Test {
  id        Int       @default(autoincrement()) @id
  title     String
  author    User?     @relation(fields: [authorId], references: [id])
  authorId  String?
  code      String
  runs      TestRun[]
  createdAt DateTime  @default(now())
  updatedAt DateTime  @default(now())
}

model User {
  id     String  @id
  email  String  @unique
  name   String?
  tests  Test[]
  apiKey ApiKey?
}

model ApiKey {
  hashed String @unique
  prefix String
  user   User   @relation(fields: [userId], references: [id])
  userId String
}

model Log {
  id        Int      @default(autoincrement()) @id
  testRun   TestRun  @relation(fields: [testRunId], references: [id])
  testRunId Int
  level     Int
  time      DateTime
  pid       Int
  hostname  String
  msg       String
  stack     String?
}
